<!-- app/templates/admin_users.html -->

{% extends "base.html" %}

{% block title %}
Admin - Manage Users
{% endblock %}

{% block content %}
<h2>Manage Users</h2>

<!-- Filter Form -->
<form method="GET" action="{{ url_for('main.admin_users') }}">
    <div>
        <label for="role">Role:</label>
        <select name="role" id="role">
            <option value="">All</option>
            {% for role in roles %}
            <option value="{{ role.id }}" {% if request.args.get('role') == role.id %}selected{% endif %}>{{ role.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label for="grade">Grade:</label>
        <input type="text" name="grade" id="grade" value="{{ request.args.get('grade', '') }}">
    </div>
    <div>
        <button type="submit">Filter</button>
    </div>
</form>

<!-- User List Form -->
<form method="POST" action="{{ url_for('main.batch_update_users') }}">
    {{ form.hidden_tag() }}
    <table>
        <thead>
            <tr>
                <th>Select</th>
                <th>ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Age</th>
                <th>Grade</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td><input type="checkbox" name="user_ids" value="{{ user.id }}"></td>
                <td>{{ user.id }}</td>
                <td>{{ user.first_name }}</td>
                <td>{{ user.last_name }}</td>
                <td>{{ user.student_profile.age if user.student_profile else 'N/A' }}</td>
                <td>{{ user.student_profile.grade if user.student_profile else 'N/A' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div>
        <button type="submit">Batch Update</button>
    </div>
</form>

{% endblock %}
